{% extends 'archives/_base.html' %}
{% from 'layouts/_macros.html' import page_navigation %}

{% block title %}Archives{% endblock %}

{% block content %}
    <table id="archive-table" class="striped" width="100%">
        <thead>
            <tr>
                <th width="10%">ID</th>
                <th width="20%">Info</th>
                <th width="60%">Data</th>
                <th width="15%">Expires</th>
                <th width="5">Action</th>
            </tr>
        </thead>
        <tbody>
            {% for item in archives.items %}
                <tr id="archive-{{ item.id }}">
                    <td>
                        <div id="id-link">{{ item.show_link }}</div>
                        {% if item.type == 'post' %}
                            <article class="archive-preview">
                                <img src="{{ item.preview_url }}">
                            </article>
                        {% endif %}
                    </td>
                    <td>
                        <strong>Type:</strong> {{ item.type | title }}<br>
                        <strong>Data key:</strong> {{ item.data_key}}
                    </td>
                    <td><div class="json-data">{{ item.data | tojson(indent=4) }}</div></td>
                    <td>{{ helpers.base.format_timestamp(item.expires) }}</td>
                    <td>
                        {{ helpers.archive.reinstantiate_item_link(item) }}
                        {% if helpers.archive.has_relink(item) %}
                            <br>{{ helpers.archive.relink_item_link(item) }}
                        {% endif %}
                        <br>
                        {% if item.expires is none %}
                            {{ helpers.archive.set_temporary_link(item) }}
                        {% else %}
                            {{ helpers.archive.set_permenant_link(item) }}
                        {% endif %}
                    </td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
{% endblock %}

{% block pages %}{{ page_navigation(archives) }}{% endblock %}
